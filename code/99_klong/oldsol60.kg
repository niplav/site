d3::{:[x=0;0;1+_ln(x)%ln(2)]}
d4::{[n];n::x;({~d3(x)>n}{x+1}:~0)-1}
d6::{,/x{(,y){x,,y}:\x}:\y}
d7::{d6(x;y),d6(y;x)}
d8::{[h];h::(**x),**|x;:[2>#(*h)-*|h;(1+|/h),,[:x],(,(*|*x)),,(*|*|x);[]]}
s60::{[n];n::x-1;:[x=0;,[0[]]:|x=1;,[1[:x]];{x@((~:'x),0)?0}:({x@<x}:(d8',/{d7(s60(*x);s60(*|x))}'flr({d3(*|x)<2+d4(*x)};{x,,n-x}'!1+n:%2)))]}
